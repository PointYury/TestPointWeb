import{r as m,ab as p,R as X,S as G,M as J,V as y,W as _,X as a,Y as l,a8 as K,aq as g,a4 as i,a5 as d,a6 as r,$ as u,ac as f,as as k,a9 as I,at as Z,au as ee,ar as $,ad as S,ao as b,av as o}from"./index-015b720c.js";import{a as h,Q as le}from"./QTable-0c728d1d.js";import{Q as F}from"./QTd-3877f253.js";import{Q as ae}from"./QPage-496596b0.js";import"./QList-50266af3.js";const R=m(),te=()=>{const q=()=>{p().get("v1/owner/all").then(c=>{R.value=c.data})},T=c=>p().put("/v1/owner",c),v=c=>p().put("/v1/owner/change-status",c),C=c=>p().post("/v1/owner",c);return{owners:R.value,addOwner:C,editOwner:T,getOwners:q,changeStatus:v}},ne=g("div",{class:"row q-mb-md"},[g("h5",null,"OWNERS")],-1),oe={class:"q-mt-md"},se={class:"full-width row wrap justify-between"},ie={class:"row"},fe=X({__name:"OwnersView",setup(q){const{owners:T,getOwners:v,editOwner:C,addOwner:c,changeStatus:B}=te(),A=m(""),L=G(),E=m(null),N=m(null),w=m(null),V=m(""),O=m(["firstName","phone","email","createdAt","status","actions"]),Q=[{name:"id",label:"ID",field:"id",align:"center"},{name:"firstName",label:"FIRST NAME",field:"firstName",align:"center"},{name:"phone",label:"PHONE",field:"phone",align:"center"},{name:"email",label:"EMAIL",field:"email",align:"center"},{name:"createdAt",label:"CREATED",field:"createdAt",align:"center"},{name:"status",label:"STATUS",field:"status",align:"center"},{name:"actions",label:"ACTIONS",field:"actions",align:"center"}],z=m([]),P=m([]),D=(t,n=!1)=>{var e;if(w.value){let s,x;n?(s="DELETE",x=o.Deleted):(s=t.status==o.Active?"DEACTIVATE":"ACTIVATE",x=t.status==o.Active?o.Inactive:o.Active),V.value=`You are going to ${s} owner ${t.firstName.toUpperCase()}. Are you sure?`,w.value.customHeader="change status",w.value.changeStatus=()=>{B({id:t.id,status:x}).then(()=>{var U;(U=w.value)==null||U.hideDialog(),v()})}}(e=w.value)==null||e.showDialog()},M=()=>{var t;z.value=[{key:"firstName",label:"First name",value:"",maxLength:50,fieldType:b.INPUT,rules:["required"]},{key:"phone",label:"Phone",value:"",prefix:"+375",maxLength:9,fieldType:b.INPUT,type:"tel",rules:["required","tel"]},{key:"email",label:"Email",value:"",maxLength:50,fieldType:b.INPUT,type:"email",rules:["required"]}],(t=E.value)==null||t.showDialog()},H=t=>{var n;P.value=[{key:"ownerId",value:t.id},{key:"firstName",label:"First name",value:t.firstName,fieldType:b.INPUT,rules:["required"]},{key:"phone",label:"Phone",value:t.phone,prefix:"+375",fieldType:b.INPUT,type:"tel",rules:["required","tel"]},{key:"email",label:"Email",value:t.email,fieldType:b.INPUT,type:"email",rules:["required"]}],(n=N.value)==null||n.showDialog()},Y=t=>{const n={};t.forEach(e=>{n[e.key]=e.value}),c(n).then(()=>{var e;(e=E.value)==null||e.hideDialog(),v()})},W=t=>{const n={};t.forEach(e=>{n[e.key]=e.value}),C(n).then(()=>{var e;(e=N.value)==null||e.hideDialog(),v()})},j=(t,n)=>{n.id&&L.push({path:`${n.id}/businesses`})};return J(()=>{v()}),(t,n)=>(y(),_(ae,{padding:""},{default:a(()=>[ne,l(K,{color:"primary",spaced:"",size:"2px"}),g("div",oe,[l(le,{flat:"",bordered:"",title:"Owners",rows:u(T),columns:Q,"row-key":"id",filter:A.value,"visible-columns":O.value,onRowClick:j},{"header-cell-id":a(e=>[l(h,{props:e},{default:a(()=>[l(i,{name:"badge",size:"1.7em",color:"light-blue-14"}),d(" "+r(e.col.label),1)]),_:2},1032,["props"])]),"header-cell-firstName":a(e=>[l(h,{props:e},{default:a(()=>[l(i,{name:"person",size:"1.5em",color:"light-blue-14"}),d(" "+r(e.col.label),1)]),_:2},1032,["props"])]),"header-cell-phone":a(e=>[l(h,{props:e},{default:a(()=>[l(i,{name:"phone_iphone",size:"1.5em",color:"light-blue-14"}),d(" "+r(e.col.label),1)]),_:2},1032,["props"])]),"header-cell-email":a(e=>[l(h,{props:e},{default:a(()=>[l(i,{name:"email",size:"1.5em",color:"light-blue-14"}),d(" "+r(e.col.label),1)]),_:2},1032,["props"])]),"header-cell-createdAt":a(e=>[l(h,{props:e},{default:a(()=>[l(i,{name:"people",size:"1.5em",color:"light-blue-14"}),d(" "+r(e.col.label),1)]),_:2},1032,["props"])]),"header-cell-status":a(e=>[l(h,{props:e},{default:a(()=>[l(i,{name:"account_circle",size:"1.5em",color:"light-blue-14"}),d(" "+r(e.col.label),1)]),_:2},1032,["props"])]),"header-cell-actions":a(e=>[l(h,{props:e},{default:a(()=>[l(i,{name:"manage_accounts",size:"1.5em",color:"light-blue-14"}),d(" "+r(e.col.label),1)]),_:2},1032,["props"])]),"body-cell-status":a(e=>[l(F,{props:e},{default:a(()=>[e.value==u(o).Active?(y(),_(f,{key:0,size:"sm",style:{width:"93px"},color:"secondary",onClick:k(s=>D(e.row),["stop"])},{default:a(()=>[l(i,{center:"",name:"check"}),d(" "+r(u(o)[e.value]),1)]),_:2},1032,["onClick"])):I("",!0),e.value==u(o).Inactive?(y(),_(f,{key:1,size:"sm",style:{width:"93px"},color:"deep-orange",onClick:k(s=>D(e.row),["stop"])},{default:a(()=>[l(i,{center:"",name:"close"}),d(" "+r(u(o)[e.value]),1)]),_:2},1032,["onClick"])):I("",!0),e.value==u(o).Deleted?(y(),_(f,{key:2,style:{width:"93px"},size:"sm",color:"grey",disable:""},{default:a(()=>[l(i,{center:"",name:"delete"}),d(" "+r(u(o)[e.value]),1)]),_:2},1024)):I("",!0)]),_:2},1032,["props"])]),"body-cell-actions":a(e=>[l(F,{props:e},{default:a(()=>[l(f,{class:"q-mr-sm",dense:"",flat:"",round:"",color:e.row.status==u(o).Deleted?"grey":"blue",icon:"edit",onClick:k(s=>H(e.row),["stop"]),disable:e.row.status==u(o).Deleted},null,8,["color","onClick","disable"]),l(f,{class:"q-ml-sm",dense:"",flat:"",round:"",color:e.row.status==u(o).Deleted?"grey":"red",icon:"delete",onClick:k(s=>D(e.row,!0),["stop"]),disable:e.row.status==u(o).Deleted},null,8,["color","onClick","disable"])]),_:2},1032,["props"])]),top:a(e=>[g("div",se,[g("div",null,[l(f,{label:"Add owner",icon:"person_add",color:"primary",onClick:M})]),g("div",ie,[l(Z,{modelValue:O.value,"onUpdate:modelValue":n[0]||(n[0]=s=>O.value=s),multiple:"",outlined:"",dense:"","options-dense":"","display-value":t.$q.lang.table.columns,"emit-value":"","map-options":"",options:Q,"option-value":"name","options-cover":"",style:{"min-width":"150px"},class:"q-mx-md"},null,8,["modelValue","display-value"]),l(ee,{dense:"",outlined:"",debounce:"300",modelValue:A.value,"onUpdate:modelValue":n[1]||(n[1]=s=>A.value=s),placeholder:"Search",class:"q-mx-md"},{append:a(()=>[l(i,{name:"search"})]),_:1},8,["modelValue"]),l(f,{flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen",onClick:e.toggleFullscreen,class:"q-mx-md"},null,8,["icon","onClick"])])])]),_:1},8,["rows","filter","visible-columns"])]),l(S,{ref_key:"dialogAddOwner",ref:E,icon:"add",header:"Add new owner",hideDialogButtons:""},{body:a(()=>[l($,{fields:z.value,onHandleSubmit:Y},null,8,["fields"])]),_:1},512),l(S,{ref_key:"dialogEditOwner",ref:N,icon:"edit",header:"Edit owner",hideDialogButtons:""},{body:a(()=>[l($,{fields:P.value,onHandleSubmit:W},null,8,["fields"])]),_:1},512),l(S,{ref_key:"confirmationDialog",ref:w,icon:"build_circle","submit-title":"YES","cancel-title":"NO",width:"500"},{body:a(()=>[d(r(V.value),1)]),_:1},512)]),_:1}))}});export{fe as default};
